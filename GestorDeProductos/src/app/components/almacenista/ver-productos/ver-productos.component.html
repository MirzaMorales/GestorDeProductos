<button class="add-product-button" (click)="openAddDialog()">Agregar Producto</button>

<!-- Cards de productos -->
<div class="product-cards">
    <div *ngFor="let producto of productos" class="product-card">
        <img [src]="producto.imagenUrl" alt="{{ producto.nombreProducto }}">
        <h3>{{ producto.nombreProducto }}</h3>
        <h3>{{ producto.codigoBarras }}</h3>
        <p>Categoría: {{ producto.categoria }}</p>
        <p>Stock: {{ producto.stockAlmacen }}</p>

        <!-- Contenedor de botones -->
        <div class="button-container">
            <button (click)="openEditDialog(producto)">Editar</button>
            <button (click)="deleteProducto(producto.id)">Eliminar</button>
            <button (click)="openExistenciasDialog(producto)">Existencias</button>
        </div>
    </div>
</div>

<!-- Cuadro de diálogo para Editar Producto -->
<div *ngIf="isEditDialogOpen" class="edit-dialog">
    <div class="dialog-content">
        <h2>Editar Producto</h2>
        <form (ngSubmit)="updateProducto()">
            <label for="nombreProducto">Nombre</label>
            <input type="text" id="nombreProducto" [(ngModel)]="currentProducto.nombreProducto" name="nombreProducto">

            <label for="codigoBarras">Código de barras</label>
            <input type="text" id="codigoBarras" [(ngModel)]="currentProducto.codigoBarras" name="codigoBarras">

            <label for="tamano">Tamaño</label>
            <select id="tamano" [(ngModel)]="currentProducto.tamano" name="tamano">
                <option *ngFor="let tamano of tamanios" [value]="tamano">{{ tamano }}</option>
            </select>

            <label for="categoria">Categoría</label>
            <select id="categoria" [(ngModel)]="currentProducto.categoria" name="categoria">
                <option *ngFor="let categoria of categorias" [value]="categoria">{{ categoria }}</option>
            </select>

            <label for="proveedor">Proveedores</label>
            <select id="proveedor" multiple (change)="actualizarProveedoresEdit($event)" name="proveedor">
                <option *ngFor="let proveedor of proveedores" [value]="proveedor"
                    [selected]="currentProducto.proveedor.includes(proveedor)">
                    {{ proveedor }}
                </option>
            </select>

            <ul>
                <li *ngFor="let proveedor of currentProducto.proveedor; let i = index">
                    {{ proveedor }} <button type="button" (click)="eliminarProveedorEdit(i)">Eliminar</button>
                </li>
            </ul>


            <label for="imagenUrl">Imagen URL</label>
            <input type="text" id="imagenUrl" [(ngModel)]="currentProducto.imagenUrl" name="imagenUrl">

            <label for="precioPieza">Precio por pieza</label>
            <input type="number" id="precioPieza" [(ngModel)]="currentProducto.precioPieza" name="precioPieza">

            <label for="precioCaja">Precio por caja</label>
            <input type="number" id="precioCaja" [(ngModel)]="currentProducto.precioCaja" name="precioCaja">

            <label for="cantidadPiezasPorCaja">Cantidad por caja</label>
            <input type="number" id="cantidadPiezasPorCaja" [(ngModel)]="currentProducto.cantidadPiezasPorCaja"
                name="cantidadPiezasPorCaja">

            <label for="existenciaExhibida">Cantidad mínima de existencias</label>
            <input type="number" id="existenciaExhibida" [(ngModel)]="currentProducto.existenciaExhibida"
                name="existenciaExhibida">

            <label for="cantidadAlmacen">Cantidad mínima de almacén</label>
            <input type="number" id="cantidadAlmacen" [(ngModel)]="currentProducto.cantidadAlmacen"
                name="cantidadAlmacen">


            <div class="dialog-buttons">
                <button type="submit" class="save-button">Guardar cambios</button>
                <button type="button" class="cancel-button" (click)="closeEditDialog()">Cancelar</button>
            </div>
        </form>
    </div>
</div>

<!-- Cuadro de diálogo para Actualizar Existencias -->
<div *ngIf="isExistenciasDialogOpen" class="existencias-dialog">
    <div class="dialog-content">
        <h2>Actualizar Existencias</h2>
        <form (ngSubmit)="actualizarStock()">
            <label for="codigoBarras">Código de Barras</label>
            <input type="text" id="codigoBarras" [(ngModel)]="productoExistencias.codigoBarras" name="codigoBarras"
                readonly>

            <label for="nombreProducto">Nombre del Producto</label>
            <input type="text" id="nombreProducto" [(ngModel)]="productoExistencias.nombreProducto"
                name="nombreProducto" readonly>

            <label for="stockNuevo">Nuevo Stock</label>
            <input type="number" id="stockNuevo" [(ngModel)]="productoExistencias.stockNuevo" name="stockNuevo">

            <div class="dialog-buttons">
                <button type="submit" class="save-button">Actualizar Stock</button>
                <button type="button" class="cancel-button" (click)="closeExistenciasDialog()">Cancelar</button>
            </div>
        </form>
    </div>
</div>

<!-- Formulario para agregar producto -->
<div *ngIf="isAddDialogOpen" class="add-dialog">
    <div class="dialog-content">
        <h2>Agregar Nuevo Producto</h2>
        <form (ngSubmit)="addProducto()">
            <label for="nombreProducto">Nombre</label>
            <input type="text" id="nombreProducto" [(ngModel)]="newProducto.nombreProducto" name="nombreProducto"
                required>

            <label for="codigoBarras">Código de barras</label>
            <input type="text" id="codigoBarras" [(ngModel)]="newProducto.codigoBarras" name="codigoBarras" required>


            <label for="tamano">Tamaño</label>
            <select id="tamano" [(ngModel)]="newProducto.tamano" name="tamano">
                <option *ngFor="let tamano of tamanios" [value]="tamano">{{ tamano }}</option>
            </select>

            <label for="marca">Marca</label>
            <select id="marca" [(ngModel)]="newProducto.marca" name="marca">
                <option *ngFor="let marca of marcas" [value]="marca">{{ marca }}</option>
            </select>

            <label for="categoria">Categoría</label>
            <select id="categoria" [(ngModel)]="newProducto.categoria" name="categoria">
                <option *ngFor="let categoria of categorias" [value]="categoria">{{ categoria }}</option>
            </select>



            <label for="imagenUrl">Imagen URL</label>
            <input type="text" id="imagenUrl" [(ngModel)]="newProducto.imagenUrl" name="imagenUrl">


            <label for="proveedorInput">Proveedor</label>
            <select id="proveedorInput" [(ngModel)]="proveedorInput" name="proveedorInput">
                <option *ngFor="let proveedor of proveedores" [value]="proveedor">{{ proveedor }}</option>
            </select>
            <button type="button" (click)="agregarProveedor()">Agregar Proveedor</button>

            <ul>
                <li *ngFor="let proveedor of newProducto.proveedor; let i = index">
                    {{ proveedor }} <button type="button" (click)="eliminarProveedor(i)">Eliminar</button>
                </li>
            </ul>


            <label for="precioPieza">Precio por pieza</label>
            <input type="number" id="precioPieza" [(ngModel)]="newProducto.precioPieza" name="precioPieza" required>

            <label for="precioCaja">Precio por caja</label>
            <input type="number" id="precioCaja" [(ngModel)]="newProducto.precioCaja" name="precioCaja">

            <label for="existenciaExhibida">Mínimo en existencias</label>
            <input type="number" id="existenciaExhibida" [(ngModel)]="newProducto.existenciaExhibida"
                name="existenciaExhibida">

            <label for="cantidadAlmacen">Mínimo en almacen</label>
            <input type="number" id="cantidadAlmacen" [(ngModel)]="newProducto.cantidadAlmacen" name="cantidadAlmacen">

            <label for="cantidadPiezasPorCaja">Cantidad por caja</label>
            <input type="number" id="cantidadPiezasPorCaja" [(ngModel)]="newProducto.cantidadPiezasPorCaja"
                name="cantidadPiezasPorCaja">

            <div class="dialog-buttons">
                <button type="submit" class="save-button">Agregar Producto</button>
                <button type="button" class="cancel-button" (click)="closeAddDialog()">Cancelar</button>
            </div>
        </form>
    </div>
</div>